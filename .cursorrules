# ðŸ›  Ironframe Cursor Execution Governance Protocol

You are executing changes within a multi-tenant, AI-orchestrated SaaS governed by /docs/TAS.md. 
Stack: Next.js 15.1.6, Prisma, Supabase, Vercel AI SDK.
Environment: Cursor IDE -> GitHub Actions -> Google Cloud (GCP).

## ðŸ›‘ Pre-Implementation Check
Before writing or modifying code:
1. Confirm change category:
   ðŸ”´ Structural (DB, RLS, 19-Agents, Ingestion, Scoring/ALE)
   ðŸŸ¡ Backend Logic (Internal API, Service Layers)
   ðŸŸ¢ UI / Non-Structural (Tailwind, Client Components)

2. If ðŸ”´ Structural:
   - Halt. Read /docs/TAS.md.
   - Confirm: Tenant isolation preserved (No cross-tenant bleed).
   - Confirm: Irongate (Agent 14) is NOT bypassed for ingestion.
   - Confirm: Irontrust (Agent 3) math reflects Medshield 11.1M, Vaultbank 5.9M, Gridcore 4.7M.
   - Confirm: LangGraph state immutability respected.

## ðŸ§ª Testing & CI/CD Enforcement
No branch may merge unless it passes the GitHub Actions / The Warden gate:
- **Unit Tests:** Vitest (Irontrust Math, Risk Buckets).
- **Integration:** Prisma/RLS (Assumed HOSTILE until proven secure via cross-tenant fail-test).
- **Snapshot Tests:** Mandatory for Irontrust math and Agent routing decisions.
- **E2E:** Playwright (Mandatory for all ðŸŸ¢ UI changes and tenant isolation validation).
- **Coverage:** â‰¥ 85% on core logic modules.
- **Financial Rule:** NO `Float` types. Use `BigInt` or `Decimal`.

## ðŸ“¤ Post-Implementation Output
After changes, Cursor must output:
TAS COMPLIANCE CHECK:
- Sections Reviewed:
- Conflict Detected: YES/NO
- Amendment Required: YES/NO

CI STATUS REPORT:
- Type Check: PASS/FAIL
- Unit/Snapshot Tests: PASS/FAIL
- Playwright E2E: PASS/FAIL
- Schema Drift: YES/NO
- GCP Deploy Readiness: YES/NO

## â›” FORBIDDEN ACTIONS
- Allowing external ingestion to bypass Irongate (Agent 14).
- Modifying Irontrust math without 100% unit test coverage and snapshot comparison.
- Reinterpreting tenant boundaries or allowing cross-tenant memory bleed in LangGraph.

"Optimize for CONTROL-FIRST architecture with structured speed."